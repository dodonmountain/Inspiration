{% extends 'base.html' %}
{% load static %}
{% block css %}
<link rel="stylesheet" href="{% static 'indexes/css/index.css' %}">
<style>
body {
    background-image: linear-gradient(to top, #09203f 0%, #537895 100%);
}
</style>
{% endblock %}

{% block body %}
<h1 class="opener">INSPIRATION</h1>
{% include '_navbar.html' %}
{% if user.is_authenticated %}
<div id='car' class="carousel fadein mt-3 mb-0">
    <h2 class="queIndicator">{{ user.first_name }} <small>님의 맞춤 대기열</small> </h2>
    <p class="d-flex mt-5 ml-4 position-fixed"><small class="mt-4 text-white-50">만약 영감이 처음이시라면? </small> <a class="text-white ml-2 mt-4" href="/rater/">초기평가 하러가기</a></p>
    <div class="carousel-row">
        {% for movie in movies %}
        <div class="carousel-tile">
            <a href="{% url 'movies:detail' movie.0.id %}"><img src="https://image.tmdb.org/t/p/w500{{ movie.0.poster_path }}" style="height: 40vh;"></a>
            <div class="text-white text-center mt-3 overflow-hidden">
                <h3 class="car-body">{{ movie.0.title }}</h3>
                <!--<p>예상 평점:<span class='rand'></span></p>-->
                <i class="fa fa-clock-o">{{ movie.0.runtime }}분</i>
                <br>
                {% for genre in movie.0.genres.all %}
                <span style="font-family: sans serif" class="p-1 ">| {{ genre.name }} |</span>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
        {% else %}
        <div style="margin-top: 15%;">
            <h1 class="display-1 font-weight-bolder text-center mt-5 text-white-50">
                로그인해서 회원님만을 위한 맞춤 리스트를 받아보세요.
            </h1>
        </div>
        {% endif %}
    </div>
</div>
</div>

<div id="popup1" class="overlay">
	<div class="popup">
		<h2>Here i am</h2>
		<a class="close" href="#">&times;</a>
		<div class="content">
			Thank to pop me out of that button, but now i'm done so you can close this window.
		</div>
	</div>
</div>
{% endblock %}

{% block script %}

<script>
    const lst = document.querySelector('#car')
    const app = document.querySelector('#app')
    const navbar = document.querySelector('#navBar')
    const rand = document.querySelectorAll('.rand')
    const tiles = document.querySelectorAll('.carousel-tile')
    let last_known_scroll_position = 0;
    let flag = false;
    window.onload = function() {
        for (let r in rand) {
            rand[r].innerText = (5 + (Math.random() * 5)).toFixed(2)
            // rand[r].innerText = "{{ movie.vote_average }}"
        }
        navbar.hidden = true
        lst.hidden = true
        setTimeout(function() {
            navbar.classList.add('fadein')
            lst.hidden = false
            navbar.hidden = false
        }, 0);
    }

            
    function sideScroll(direction,speed,distance,step){
        scrollAmount = 0;
        var slideTimer = setInterval(function(){
            if(direction == 'left'){
                lst.scrollLeft -= step;
            } else {
                lst.scrollLeft += step;
            }
            scrollAmount += step;
            if(scrollAmount >= distance){
                window.clearInterval(slideTimer);
            }
        }, speed);
    }
    window.addEventListener('wheel', function(e) {
        if (e.deltaY > 0) {
            sideScroll('right',3,360,5)
        } else {
            sideScroll('left',3,360,5)
        }
        })

            

        
</script>

{% endblock %}