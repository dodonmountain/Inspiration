{% extends 'base.html' %}
{% block css %}
<style>
    html {
        height: 100vh;
    }

    body {
        background-color: #1f1f1f;
        height: 100vh
    }

    .starField {
        background: transparent;
        bottom: 0;
        padding: 0;
        margin: 0;
        color: transparent;
        font-size: 9vw;
        text-shadow: white;
        transition: 250ms;
        position: fixed;
    }

    .twinkle {
        animation: twin 0.3s
    }

    @keyframes twin {
        from {
            color: orange;
            transform: rotate(0deg);
        }

        to {
            color: transparent;
            transform: rotate(270deg);
        }
    }

    :root {

        /* Tile Dimensions */
        --carousel-tile-spacing: 10px;
        --carousel-tile-width: 5rem;
        --carousel-tile-height: calc(var(--carousel-tile-width) / (16 / 9));

        /* Growth Factor */
        --carousel-growth-factor: 2;

        /* Fade to Opacity */
        --carousel-fade-opacity: 0.25;
        --carousel-normal-opacity: 1;

        /* Automatic Offsets - DO NOT ALTER */
        --carousel-offset-left: calc(-1 * (var(--carousel-tile-width) * (var(--carousel-growth-factor) - 1) / 2));
        --carousel-offset-right: calc(var(--carousel-tile-width) * (var(--carousel-growth-factor) - 1));

        /* Transition Speeds */
        --carousel-transition-1: 1s;
        --carousel-transition-2: 0.5s;
        --carousel-transition-3: 0.3s;

    }

    /* Carousel Container */
    .carousel {
        overflow: hidden;
        white-space: nowrap;
        height: 100vh;
    }

    /* Carousel Row */
    .carousel-row {
        white-space: nowrap;
        margin-top: 0rem;
        margin-left: calc((var(--carousel-tile-width) * (var(--carousel-growth-factor) - 1)) / 2);
        margin-right: calc((var(--carousel-tile-width) * (var(--carousel-growth-factor) - 1)) / 2);
        transition: var(--carousel-transition-2);
    }

    .carousel-card {
        width: 5rem;
    }

    /* Content Tile */
    .carousel-tile {
        position: relative;
        display: inline-block;
        margin-left: 2rem;
        width: 20rem;
        height: var(--carousel-tile-height);
        margin-right: 17rem;
        transition: var(--carousel-transition-2);
        -webkit-transform-origin: center left;
        transform-origin: center left;
        cursor: pointer;
        cursor: hand;
    }

    /* Add Extra Margin to Last Carousel Tile */
    .carousel-tile:last-of-type {
        margin-right: calc(var(--carousel-tile-width)/2);
    }

    /* Ensure All Elements Inside Tile are Block */
    .carousel-tile * {
        width: 16vw;
    }

    .carousel-tile>a>img {
        border-radius: 10%;
    }

    /* Carousel Row on Hover */
    .carousel-row-hover {
        -webkit-transform: translate3d(var(--carousel-offset-left), 0, 0);
        transform: translate3d(var(--carousel-offset-left), 0, 0);
    }

    /* Content Tile on Carousel Row Hover */
    .carousel-row-hover .carousel-tile {
        opacity: var(--carousel-fade-opacity);
    }

    /* Content Tile on Hover on Carousel Row Hover */
    .carousel-row-hover .carousel-tile-hover {
        -webkit-transform: scale(var(--carousel-growth-factor));
        transform: scale(var(--carousel-growth-factor));
        opacity: var(--carousel-normal-opacity);
    }

    .car-body {
        font-family: 'Arial Narrow Bold', sans-serif;
    }
</style>
{% endblock css %}

{% block body %}
<div id='car' class="carousel fadein mt-3 mb-0 h-100">
    <div class="carousel-row carousel-row-hover">
        {% for movie in movies %}
        <div class="carousel-tile">
            <a href="{% url 'movies:detail' movie.id %}"><img src="https://image.tmdb.org/t/p/w500{{ movie.poster_path }}" style="height: 40vh;"></a>
            <div class="text-white text-center mt-3 overflow-hidden">
                <h3 class="car-body">{{ movie.title }}</h3>
                <i class="fa fa-clock-o">{{ movie.runtime }}분</i>
                <br>
                {% for genre in movie.genres.all %}
                <span style="font-family: sans serif" class="p-1 ">| {{ genre.name }} |</span>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>
<div class="starField container-fluid">
    <div class="row justify-content-lg-around">
        <div id="star1">★</div>
        <div id="star2">★</div>
        <div id="star3">★</div>
        <div id="star4">★</div>
        <div id="star5">★</div>
        <div id="star6">★</div>
        <div id="star7">★</div>
        <div id="star8">★</div>
        <div id="star9">★</div>
        <div id="star10">★</div>
    </div>
</div>
{% endblock body %}

{% block script %}
<script>
    const star1 = document.getElementById('star1')
    const star2 = document.getElementById('star2')
    const star3 = document.getElementById('star3')
    const star4 = document.getElementById('star4')
    const star5 = document.getElementById('star5')
    const star6 = document.getElementById('star6')
    const star7 = document.getElementById('star7')
    const star8 = document.getElementById('star8')
    const star9 = document.getElementById('star9')
    const star10 = document.getElementById('star10')
    const Stars = [star1, star2, star3, star4, star5, star6, star7, star8, star9, star10]
    let pressedScore;
    pressedScore = 0
    let passThis = false;
    let movieNow = 1;
    let target = document.querySelectorAll('.carousel-tile')[movieNow]

    function sideScroll(direction, speed, distance, step) {
        scrollAmount = 0;
        var slideTimer = setInterval(function() {
            if (direction == 'left') {
                car.scrollLeft -= step;
            } else {
                car.scrollLeft += step;
            }
            scrollAmount += step;
            if (scrollAmount >= distance) {
                window.clearInterval(slideTimer);
            }
        }, speed);
    }
    window.onkeydown = function() {
        if (event.keyCode == 81) {
            pressedScore = 1
        } else if (event.keyCode == 87) {
            pressedScore = 2
        } else if (event.keyCode == 69) {
            pressedScore = 3
        } else if (event.keyCode == 82) {
            pressedScore = 4
        } else if (event.keyCode == 84) {
            pressedScore = 5
        } else if (event.keyCode == 89) {
            pressedScore = 6
        } else if (event.keyCode == 85) {
            pressedScore = 7
        } else if (event.keyCode == 73) {
            pressedScore = 8
        } else if (event.keyCode == 79) {
            pressedScore = 9
        } else if (event.keyCode == 80) {
            pressedScore = 10
        } else if (event.keyCode == 32) {
            passThis = true
        }
        if (0 < pressedScore < 11) {
            for (let i = 0; i < pressedScore; i++) {
                setTimeout(() => {
                    Stars[i].classList.add('twinkle')
                }, 250)
                	Stars[i].classList.remove('twinkle')
								};
						console.log(event)
						car.scrollLeft += 629.2
						pressedScore = 0
						target = document.querySelectorAll('.carousel-tile')[movieNow]
						target.classList.remove('carousel-tile-hover')
						movieNow += 1
						document.querySelectorAll('.carousel-tile')[movieNow].classList.add('carousel-tile-hover')
					};
        };
</script>
{% endblock script %}